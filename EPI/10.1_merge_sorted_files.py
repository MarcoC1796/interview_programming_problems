# Problem: write a program that taks as input a set of sorted sequences and computes the union of
#          these sequence. For example, is the input is <3, 5, 7>, <0, 6>, and <0, 6, 28>, then the output is
#          <0, 0, 3, 5, 6, 6, 7, 28>
import heapq

# EPI Judge: sorted_array_merge.py
def merge_sorted_arrays(sorted_arrays):
    min_heap = []
    for i, array in enumerate(sorted_arrays):
        if len(array) > 0:
            heapq.heappush(min_heap, (array[0], i, 0))

    sorted_merge = []
    while min_heap:
        next_e, i, j = heapq.heappop(min_heap)
        sorted_merge.append(next_e)
        if j + 1 < len(sorted_arrays[i]):
            heapq.heappush(min_heap, (sorted_arrays[i][j + 1], i, j + 1))

    return sorted_merge

if __name__ == "__main__":
    sorted_arrays = [[-14, 4, 29], [-29, -26, -23, -20, -14, -8, -7, -3, 0, 1, 2, 7, 10, 11, 22, 26], [-33, -30, -28, -27, -26, -15, -8, 3, 3, 6, 7, 15, 17, 17, 22, 24, 27, 28, 29, 32], [-30, -27, -26, -25, -21, -20, -19, -16, -16, -16, -15, -15, -14, -14, -10, -10, -10, -9, -9, -6, 0, 6, 7, 8, 15, 18, 18, 21, 31, 32], [-30, -21, -19, -11, -11, 1, 9, 9, 12, 25], [-30, -13, -9, -7, 13, 23, 32], [-27, -22, -13, -12, -5, 7, 11, 16, 18, 22, 28, 31, 33], [-32, -30, -28, -27, -27, -23, -23, -19, -17, -16, -14, -13, -13, -10, -9, -8, -5, -4, -3, 1, 3, 6, 7, 7, 8, 15, 21, 21, 27, 32], [-26, 2, 9, 24], [-31, -30, -21, -20, -19, -19, -16, -11, -9, -8, -7, -5, -5, -4, -4, -2, -1, 7, 8, 16, 17, 21, 21, 23, 24, 31], [-33, -33, -31, -31, -31, -31, -29, -28, -27, -25, -25, -22, -14, -11, -4, 1, 8, 8, 9, 12, 15, 16, 18, 19, 22, 23, 26], [-30, -28, -28, -27, -23, -21, -19, -15, -13, -13, -13, -13, -13, -11, -9, -8, -8, -8, -1, 0, 2, 7, 8, 8, 9, 13, 15, 16, 19, 22, 24, 32, 33], [-24, -21, -19, -12, -11, -11, -11, -5, -5, -1, 2, 2, 3, 4, 8, 11, 14, 22, 25, 25, 27, 28, 30, 32], [-32, -32, -30, -30, -28, -26, -23, -18, -16, -15, -14, -12, -10, -6, -5, -2, -1, 3, 4, 8, 12, 14, 15, 20, 22, 24, 24, 25, 27, 27, 28, 30, 33], [-31, -19, -19, -18, -14, -14, -13, -8, -8, 5, 6, 12, 16, 23, 28, 33], [11, 17], [-33, -30, -29, -29, -28, -28, -27, -26, -25, -19, -18, -16, -15, -12, -5, -2, 6, 9, 14, 18, 18, 18, 21, 22, 23, 23, 29, 31, 32], [-30, -28, -24, -23, -23, -20, -15, -13, -11, -3, -2, 2, 2, 8, 10, 12, 17, 17, 17, 20, 22, 30, 30, 32], [-31, -29, -24, -24, -24, -18, -16, -11, -11, -8, -6, -5, -4, -2, 0, 0, 2, 5, 8, 10, 10, 10, 11, 13, 13, 14, 17, 17, 21, 24, 24, 27, 32], [8, 15, 22], [-29, -25, -20, -11, -8, -6, -5, -3, 0, 4, 6, 7, 11, 18, 21, 23, 26, 33], [4, 14], [-32, -32, -32, -31, -28, -27, -26, -19, -17, -12, -6, 6, 8, 11, 15, 19, 20, 27, 32], [-31, -30, -26, -21, -16, -16, -13, -6, -6, -2, 2, 10, 13, 19, 20, 22, 26, 26, 29, 31, 33], [-27, -27, -27, -21, -18, -16, -15, -14, -14, -9, -8, -7, -7, -6, -3, 1, 7, 8, 8, 11, 14, 16, 17, 17, 19, 21, 23, 24, 24], [-33, -33, -27, -8, -1, 3, 6, 7, 18, 32, 33], [-33, -27, -24, -24, -23, -18, -17, -14, -11, -8, -5, -5, 11, 12, 14, 16, 24, 24, 27], [-31, -28, -19, -14, -13, -11, -8, -6, 5, 7, 7, 7, 9, 15, 17, 20, 32, 32], [-30, -28, -25, 0, 7, 24, 26, 26, 29, 33], [-33, -32, -28, -26, -25, -20, -19, -19, -14, -8, -7, -2, 1, 2, 3, 4, 4, 6, 6, 7, 8, 8, 9, 15, 17, 17, 19, 19, 23, 27], [-25, -18, -12, -3, 8, 19, 21], [-16], [-33, -32, -31, -29, -21, -20, -19, -19, -18, -14, -13, -13, -12, -8, -6, -4, -2, -2, -1, 1, 1, 3, 5, 13, 14, 18, 24, 25, 26, 27, 29]]
    print(merge_sorted_arrays(sorted_arrays))